<h1>Access Control</h1>
<h2>1. Access Control là gì?</h2>
<p><b>Access Control</b> là kiểm soát quyền hạn user/hệ thống được phép làm/không được làm gì.</p>
<p>Trong web app, nó dựa trên ba phần:</p>
<ul>
  <li><b>Authentication</b>: xác minh bạn là ai (login).</li>
  <li><b>Session management</b>: gắn request vào đúng user.</li>
  <li><b>Access control</b>: quyết định user đó có đủ quyền hay không.</li>
</ul>

<h2>2. Vertical Privilege Escalation (Leo quyền dọc)</h2>
<p>Xảy ra khi user thấp quyền truy cập được chức năng dành cho user cao quyền hơn (VD như admin).</p>
<h3>2.1. Unprotected Functionality</h3>
<p>Ứng dụng có trang admin nhưng không kiểm tra quyền khi truy cập URL.</p>
<p>Ví dụ: <code>https://insecure-website.com/admin</code></p>
<p>=> Dù UI không có link, user vẫn có thể tự truy cập.</p>
<p>URL nhạy cảm đôi khi bị lộ qua:</p>
<ul>
  <li>file robots.txt: <code>https://insecure-website.com/robots.txt</code></li>
  <li>brute-force dựa trên wordlist: Ví dụ attacker brute-force <code>/admin</code>, <code>/administrator</code>, <code>/cpanel</code>, v.v.</li>
</ul>

<h3>2.2 Security by Obscurity</h3>
<p>Ví dụ URL quản trị được đặt khó đoán hơn: <code>https://insecure-website.com/administrator-panel-yb556</code></p>
<p>=> Nhìn thì an toàn, nhưng vẫn sai vì hệ thống vẫn không kiểm quyền.</p>
<p>Và đôi khi URL bị lộ trong JavaScript:</p>
<pre><script>
    var isAdmin = false;
    if (isAdmin) {
        ...
        var adminPanelTag = document.createElement('a');
        adminPanelTag.setAttribute('href', 'https://insecure-website.com/administrator-panel-yb556');
        adminPanelTag.innerText = 'Admin panel';
        ...
    }
</script></pre>
<p>→ Dù UI không hiển thị link admin khi <code>isAdmin = false</code>, JavaScript vẫn được gửi xuống cho mọi user, ai cũng xem được source và thấy URL admin.</p>

<h3>2.3. Parameter-based Access Control</h3>
<p>Một số ứng dụng xác định quyền từ thông tin user có thể chỉnh sửa như:</p>
<ul>
  <li>hidden field trong form</li>
  <li>cookie dạng text có thể chỉnh</li>
  <li>query parameter trong URL</li>
</ul>
<p>Ví dụ URL: <code>https://insecure-website.com/login/home.jsp?admin=true</code><br>hoặc: <code>https://insecure-website.com/login/home.jsp?role=1</code></p>
<p>Chỉ cần đổi <code>admin=false</code> → <code>admin=true</code> là thành admin.</p>

<h2>3. Horizontal Privilege Escalation</h2>
<p>User truy cập dữ liệu của user khác cùng cấp quyền.</p>
<p>Ví dụ app sử dụng: <code>https://insecure-website.com/myaccount?id=123</code></p>
<p>Nếu attacker đổi thành: <code>https://insecure-website.com/myaccount?id=456</code>, họ có thể xem tài khoản của người khác.</p>
<p>=>Đây là lỗi IDOR – Insecure Direct Object Reference.</p>
<p><strong>GUID không đảm bảo an toàn</strong></p>
<p>Nhiều dev nghĩ dùng GUID thay id sẽ an toàn: <code>?id=c23fa817-09de-4b34-88ab-a7c1395f8b33</code></p>
<p>Nhưng attacker vẫn có thể lấy GUID của người khác từ comment, review, message, API call, danh sách user.</p>
<p>=> App vẫn thiếu kiểm quyền thì vẫn bị khai thác.</p>

<h2>4. Horizontal → Vertical Privilege Escalation</h2>
<p>Nếu attacker dùng Horizontal để truy cập vào tài khoản admin, họ có thể biến nó thành Vertical bằng cách:</p>
<ol>
  <li>đặt lại mật khẩu của admin</li>
  <li>lấy thông tin nhạy cảm</li>
  <li>truy cập trang admin</li>
  <li>thực hiện chức năng đặc quyền cao</li>
</ol>
<p>Ví dụ attacker dùng IDOR: <code>https://insecure-website.com/myaccount?id=456</code></p>
<p>Nếu id 456 thuộc admin → attacker vào được trang admin và từ đó kiểm soát toàn bộ hệ thống.</p>
